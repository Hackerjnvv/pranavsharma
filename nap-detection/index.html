<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Face - Single File Game</title>
    
    <!-- Step 1: CSS code ko <style> tag ke andar daalein -->
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #2c3e50;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .game-container {
            position: relative;
            border: 5px solid #ecf0f1;
            box-shadow: 0 0 25px rgba(236, 240, 241, 0.4);
            border-radius: 10px;
            overflow: hidden;
        }

        canvas {
            background-color: #87CEEB; /* Sky Blue */
            display: block;
        }

        .menu-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.65);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: opacity 0.3s;
        }

        .menu-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        #menu-title {
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px #000;
        }

        #menu-score {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .upload-wrapper {
            margin: 20px 0;
        }

        .upload-wrapper label {
            background-color: #27ae60;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .upload-wrapper label:hover {
            background-color: #2ecc71;
        }

        .upload-wrapper input[type="file"] {
            display: none;
        }

        #startButton {
            padding: 15px 30px;
            font-size: 1.2rem;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.2s;
        }

        #startButton:hover {
            background-color: #c0392b;
        }

        .instructions {
            margin-top: 20px;
            font-size: 1rem;
        }
    </style>
</head>
<body>

    <!-- Step 2: HTML ka structure -->
    <div class="game-container">
        <canvas id="gameCanvas" width="400" height="600"></canvas>
        <div id="menu" class="menu-overlay">
            <h1 id="menu-title">Flappy Face</h1>
            <p id="menu-score"></p>
            <div class="upload-wrapper">
                <label for="imageUpload">Apna Chehra Upload Karein</label>
                <input type="file" id="imageUpload" accept="image/*">
            </div>
            <button id="startButton">Start Game</button>
            <p class="instructions">Upar jaane ke liye 'Spacebar' ya 'Tap' karein</p>
        </div>
    </div>

    <!-- Step 3: JavaScript code ko <script> tag ke andar daalein -->
    <script>
        // --- DOM Elements ---
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const menu = document.getElementById('menu');
        const startButton = document.getElementById('startButton');
        const imageUpload = document.getElementById('imageUpload');
        const menuTitle = document.getElementById('menu-title');
        const menuScore = document.getElementById('menu-score');

        // --- Game Constants & Variables ---
        const GRAVITY = 0.5;
        const FLAP_STRENGTH = -8;
        const PIPE_SPEED = 3;
        const PIPE_GAP = 180;
        const PIPE_WIDTH = 80;
        const PIPE_INTERVAL = 1500; // milliseconds

        let player, pipes, score, isGameOver, pipeIntervalId;

        // --- Player Image (Default Image is embedded using Base64) ---
        const playerImage = new Image();
        // Yeh default smiley face ka Base64 data hai. Isse image file ki zaroorat nahi.
        playerImage.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAFsklEQVR4Xu2afYxdVRXHP/fcu7e7t8suIC1SSy9S0oZiFfsgIZqgVhNM1IiJiY8JPiD4Y/CDJvghEh9q/GGMCiS+aIKaPjT4I0ZCAxITK4UaClpaWugu3dvd3XvPnbvvOXeP3btdunbLdY/snZl99tl7rb32Xnuf5chv+Ue9gQ1gK7AdOA6cAk4C+zQ0/zrwI3AE+A2Yo6r+JAFsBQ4DlwOPgX1qgS/AHeAW8LGquq8U8AswDvgC+Dwwv/9ngSeBFwJ/3gXmAQeAdYC3gL1mQ5fAGWADsB3YXA7/FPAk8L4qut+AmcAx4FngV+Cj2bBVwClgM3A18Gg5/K3A36qa6YGbA0cBq4GbgM1mI5eA/cCFwP1AcjvwUFXNNEDyMeAwcCPwN2BH27FSwJnAheBxzcAnqurTAbLjgGPARuAb4D3bhX0G7AbOAO+1p/gBVfVlA4j3A7cCZwPfAj/aruxK4HjgOXA/MOh7rKrL24C8C/g9cB04F/jMdmZXAp8ADwL/Cwh+pKp+3Abk3cDbwN+A/xW7/yPwkqp6qQ1E+z7wX2BP1VdMEdxS9b2qWlwk4TjwA3AX2A5cNvA1VXV5my5l+B24CXiU+c3A66rqe226lKHHgYcBvwK7VXX3VMP3Kuo3bLqWoc+BWcDzwM+BL6mqlzbF9/3Ah6vqk83K0CvgKOB+oN+Xq6oPtv4p6i/gI+B8oA/93Kp6Z6v+FvVd4DXgUuCfqurrrc5fUXeBW4HTgX3AharqB1uVP0X9AngauBU4HFiz/5Kqet2G5X80+jFwN3CgYdJvqupvG5T/59GLgDuBXyqmS+8w/F9E/R14Hvh4hZ2p6vJ2Yl8T9SnwN3C6xP+rqm+1k70i6gvgN8BDUv4WqmpVf77XN88E3gS+U3w+qaofb6f2iKgHgc+AXUIdv6uqgq3v895pYK/U/Rir6p7aHl9R9QPwA+BHQo4/q6oHtzp/RtwIPADsB+Z7/qKqu2g7fkXsB14F/lV8t6mqh7Y9fkXcC3wI/L+E/6CqHrDteRVxGPA9cKj476mqf7TteRXRlGngC+E/JXybqrq9HfErIkX7gUeALbZ+r6rPbH/8isgL4Fng+e1b1vT17YxfEUnwM+A/hWxfVt/e/vgVEZcGwN9L2D5VddD25K+IZPg5cLh4u6jqv9mV/RWRA38FXi/hO6iq325f/orIQYF934L3qarebs/+ikj4JcAnJRw/qKovb19+RSR8DvhRhbOjqj64ffkVEfH3gE9L2EFV3bZ9eRWR8VPAH0vYl6r62vbkL4iImcB/Sth7VXXP9uQviIiRwC9L+P6q+oztz18REYcC3y5hG1V19/bhr4gIuAf8pYQVVTXP9uGviEjwLeDXJWyhqj6y/fErIhl+CvyjhM1V1e+2L39FJEPAwRK2UlV/2778FUngE+BPJWxFVT2+/fErIhn+PPCjEiaBG4Gzq+p325W/IjIWeAz4W+Wf04H7VNWn25u/IiJWAMdL2L2qut/25i+IiFbgkRL2UlU3bG/+iohYDXwoYVdVde3256+ISMwE/kLCxqp6e/vzV0QkuAx8W8JeVfXn7c1fERGLgf8pYWdV9d/bm78iIqYBnyphF1V1R/v0L4gIYcCzJWx+4E5V9X/bT3yKiBgLfLWEVVXV4e0nPiUisA78qITfJmAdUFUt2l58SsSwAnxawo+AvYC9qupm24pPibgA3yphW1V1VfviUxJcAT5ewg+B3QDHVPWt7YtPEU3whRL+W/9W4Oeq6uBqU8RXcQG+V8InARuAn6uq1zc+B+yL70X4tYS/F5gI7P/uUFVNbV4+9L+l4F/gY0W1V8lT/w/n7s/2x3+H+B+w/6uqqsX3YwYAAAAASUVORK5CYII=';
        
        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                playerImage.src = URL.createObjectURL(file);
            }
        });

        // --- Sound Setup ---
        // Yahan apni MP3 files ke naam daalein jo 'sounds' folder mein hain
        const soundFiles = ['sounds/sound1.mp3', 'sounds/sound2.mp3', 'sounds/sound3.mp3'];
        const obstacleSounds = soundFiles.map(src => new Audio(src));

        function playRandomSound() {
            if (obstacleSounds.length > 0 && obstacleSounds[0].duration > 0) { // Check if sounds are loaded
                const sound = obstacleSounds[Math.floor(Math.random() * obstacleSounds.length)];
                sound.currentTime = 0; // Rewind to start
                sound.play().catch(error => {
                    // Browser aksar user interaction ke bina sound play nahi hone deta
                    console.log("Sound play was blocked by the browser.");
                });
            }
        }

        // --- Player Object ---
        function createPlayer() {
            return {
                x: 80, y: canvas.height / 2,
                width: 50, height: 50,
                velocityY: 0,
                draw() {
                    ctx.save();
                    ctx.beginPath();
                    ctx.arc(this.x + this.width / 2, this.y + this.height / 2, this.width / 2, 0, Math.PI * 2, true);
                    ctx.closePath();
                    ctx.clip();
                    ctx.drawImage(playerImage, this.x, this.y, this.width, this.height);
                    ctx.restore();
                },
                update() {
                    this.velocityY += GRAVITY;
                    this.y += this.velocityY;
                    if (this.y < 0) {
                        this.y = 0;
                        this.velocityY = 0;
                    }
                },
                flap() {
                    this.velocityY = FLAP_STRENGTH;
                }
            };
        }

        // --- Pipe Functions ---
        function createPipe() {
            const gapY = Math.random() * (canvas.height - PIPE_GAP - 120) + 60;
            pipes.push({ x: canvas.width, y: gapY, passed: false });
            playRandomSound();
        }

        function updatePipes() {
            for (let i = pipes.length - 1; i >= 0; i--) {
                let p = pipes[i];
                p.x -= PIPE_SPEED;
                if (!p.passed && p.x + PIPE_WIDTH < player.x) {
                    score++;
                    p.passed = true;
                }
                if (p.x + PIPE_WIDTH < 0) {
                    pipes.splice(i, 1);
                }
            }
        }

        function drawPipes() {
            ctx.fillStyle = '#228B22'; // Forest Green
            ctx.strokeStyle = '#006400';
            ctx.lineWidth = 4;
            pipes.forEach(p => {
                ctx.fillRect(p.x, 0, PIPE_WIDTH, p.y);
                ctx.strokeRect(p.x, 0, PIPE_WIDTH, p.y);
                ctx.fillRect(p.x, p.y + PIPE_GAP, PIPE_WIDTH, canvas.height - p.y - PIPE_GAP);
                ctx.strokeRect(p.x, p.y + PIPE_GAP, PIPE_WIDTH, canvas.height - p.y - PIPE_GAP);
            });
        }

        // --- Collision Detection ---
        function checkCollision() {
            if (player.y + player.height > canvas.height) return true;
            for (const p of pipes) {
                if (player.x < p.x + PIPE_WIDTH && player.x + player.width > p.x &&
                    (player.y < p.y || player.y + player.height > p.y + PIPE_GAP)) {
                    return true;
                }
            }
            return false;
        }

        // --- Game State Functions ---
        function resetGame() {
            player = createPlayer();
            pipes = [];
            score = 0;
            isGameOver = false;
            menu.classList.add('hidden');
            if (pipeIntervalId) clearInterval(pipeIntervalId);
            pipeIntervalId = setInterval(createPipe, PIPE_INTERVAL);
            gameLoop();
        }

        function gameOver() {
            isGameOver = true;
            clearInterval(pipeIntervalId);
            menu.classList.remove('hidden');
            menuTitle.textContent = "Game Over!";
            menuScore.textContent = `Aapka Score: ${score}`;
            startButton.textContent = "Phir se Khelein";
        }

        function drawScore() {
            ctx.fillStyle = 'white';
            ctx.font = 'bold 30px Segoe UI';
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.strokeText(`Score: ${score}`, 10, 40);
            ctx.fillText(`Score: ${score}`, 10, 40);
        }

        // --- Main Game Loop ---
        function gameLoop() {
            if (isGameOver) return;
            requestAnimationFrame(gameLoop);
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            player.update();
            updatePipes();

            drawPipes();
            player.draw();
            drawScore();
            
            if (checkCollision()) {
                gameOver();
            }
        }

        // --- Event Listeners ---
        startButton.addEventListener('click', resetGame);
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !isGameOver) player.flap();
        });
        document.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!isGameOver) player.flap();
        }, { passive: false });

        // Initial menu setup
        menuScore.textContent = '';
    </script>
</body>
</html>
